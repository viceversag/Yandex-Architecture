# Project_template


# Задание 1. Анализ и планирование

<aside>

Компания "Теплый дом" устанавливает датчики температуры в дома и управляет ими. Компанией разработана информационная система для регистрации датчиков, визуализации их показаний и доступа пользователей к удаленной установке температуры и просмотра текущих показаний.   

</aside

### 1. Описание функциональности монолитного приложения

**Управление отоплением:**

- Пользователи могут устанавливать необходимый уровень температры в помещениях
- Система поддерживает передачу выбранных параметров в "умные" датчики


**Мониторинг температуры:**

- Пользователи могут просматривать текущие показатели температуры
- Система поддерживает запросы информации о текущем уровне температуры с "умного" датчика

**Управление датчиками:**

- Администратор системы может зарегистрировать датчик после его установки
- Система поддерживает процесс регистрации нового датчика в системе

**Управление пользователями:**

- Пользователи могут зарегистрироваться в системе и указать особенности помещения, где будут установлены датчики
- Система поддерживает процесс регистрации в пользователей системе
- Система поддерживает процесс аутентификации и авторизации пользователей 

### 2. Анализ архитектуры монолитного приложения

- Язык программирования :Go
- База данных: СУБД Postgres
- Взаимодействие между приложением и БД синхронно
- Управление от приложения к датчику

### 3. Определение доменов и границы контекстов

**Домен управления пользователями**

- Контекст регистрации пользователей
- Контекст авторизации и аутентификации пользователей

**Домен управления датчиками**

- Контекст регистрации датчика в системе
- Контекст размещения датчика на плане / списке комнат
- Контекст наличия типов датчиков на складе

**Домен сбора информации**

- Контекст сбора информации с датчиков
- Контекст визуализации информации от датчиков

**Домен регистрации действий**

- Логирование действий пользователей
- Логирование перемещения / удаления датчиков
- Логирование обращений пользователей

**Домен поставщиков датчиков**

- Контекст регистрации поставщиков
- Контекст верификации датчика ТПУ 

**Домен поддержки пользователей**

- Контекст ведения процесса обращений пользователей

### **4. Проблемы монолитного решения**

- Весь функционал в одном месте. Если необходимо изменить что-то в управлении датчика (например позволить пользователям "перенести" датчик из одного помещения в другое), то, необходимо пересобирать всю систему
- Еще видится проблема в единственной БД: данные о датчиках и пользователях храняться в одном месте
- Ну и ожидаемое расширение в проекте скорее всего принесет проблемы с масштабированием: количество датчиков кратно увеличится.

### 5. Визуализация контекста системы — диаграмма С4

[Контекстная диаграмма](https://github.com/viceversag/Yandex-Architecture/blob/warmhouse/diagrams/context/Warmhouse_context.puml)

# Задание 2. Проектирование микросервисной архитектуры


**Диаграмма контейнеров (Containers)**

[Диаграмма контейнеров](https://github.com/viceversag/Yandex-Architecture/blob/warmhouse/diagrams/container/Warmhouse_container.puml)

**Диаграмма компонентов (Components)**

Микросервисов много. Диаграмму компонентов сделал только одного. Остальные будут похожи. Иначе диаграмма становиться нечитаемой

[Диаграмма компонентов](https://github.com/viceversag/Yandex-Architecture/blob/warmhouse/diagrams/component/Warmhouse_component.puml)

**Диаграмма кода (Code)**

[Диаграмма кода](https://github.com/viceversag/Yandex-Architecture/blob/warmhouse/diagrams/code/Warmhouse_code.puml)

# Задание 3. Разработка ER-диаграммы

[ER диаграмма](https://github.com/viceversag/Yandex-Architecture/blob/warmhouse/diagrams/er/Warmhouse_entity.txt)

# Задание 4. Создание и документирование API

### 1. Тип API

Для взаимодействия сервисов буду использовать 2 типа API:

- Для отправки текущих данных с датчиков от сервиса датчиков в Web приложение буду использовать брокер сообщений (RabbitMQ, Kafka). Выбор сделан из того, что постоянные опросы Web приложением текущих данных накладны. Поэтому лучше будет отправлять данные в обратном направлении. Как вариант можно использовать web hooks.
- Для все остальных взаимодействий рационально использовать RestAPI, потому как состояние сохранять не надо, общение должно быть легковесным и стандартным

### 2. Документация API

[Документация API](https://github.com/viceversag/Yandex-Architecture/blob/warmhouse/openapi.yml)

# Задание 5. Работа с docker и docker-compose

В папке src в каталоге main лежит код приложения, в папке db лежит скрипт инициализации базы данных, в папке test коллекция для тестирования приложения.

Основной файл сборки docker-compose.yml в каталоге src, файл сборки приложения в каталоге main